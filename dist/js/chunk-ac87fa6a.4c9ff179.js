(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-ac87fa6a"],{"0d33":function(e,n,t){"use strict";var a=t("c592");t.n(a).a},"3b7d":function(e,n,t){"use strict";t.r(n);t("4de4"),t("4e82"),t("0d03"),t("d3b7"),t("6062"),t("3ca3"),t("ddb0");var a=t("2909"),i=t("b85c"),r=t("b775"),l=t("e819"),o=(t("6287"),t("caad"),t("d81d"),t("13d5"),t("fb6a"),t("2532"),t("313e")),u={name:"MonthBilling",props:["monthBillingResource","year"],data:function(){return{collapseActiveKey:[1,2],filteredInfo:null,monthList:["01","02","03","04","05","06","07","08","09","10","11","12"]}},mounted:function(){this.billingChart()},computed:{columns:function(){var e,n=this.filteredInfo,t=[{dataIndex:"YunFuWuZhangDan_VISIBLE_NAME",title:"账单"},{title:"账期",key:"YunFuWuZhangDan_YueFen",scopedSlots:{customRender:"costDate"},filters:[],filteredValue:(n=n||{}).YunFuWuZhangDan_YueFen||null,onFilter:function(e,n){return(n.YunFuWuZhangDan_ZhangDanNianFen+"-"+n.YunFuWuZhangDan_YueFen).includes(e)}},{title:"云服务商",scopedSlots:{customRender:"cloudProvider"}},{title:"付款主体",dataIndex:"YunFuWuZhangDan_FuKuanZhuTi"},{title:"帀种",scopedSlots:{customRender:"currencyType"}},{title:"金额",scopedSlots:{customRender:"cost"},sorter:function(e,n){return n.YunFuWuZhangDan_FeiYong-e.YunFuWuZhangDan_FeiYong}}],a=Object(i.a)(this.monthList);try{for(a.s();!(e=a.n()).done;){var r=e.value;t[1].filters.push({text:this.year+"-"+r,value:this.year+"-"+r})}}catch(e){a.e(e)}finally{a.f()}return t}},methods:{billingChart:function(){var e,n=this,t=[],a=this.monthBillingResource.length?"("+this.monthBillingResource[0].YunFuWuZhangDan_HuoBiDanWei.slice(2,10)+")":"",r=Object(i.a)(this.monthList);try{var l=function(){var a=e.value,i=n.monthBillingResource.reduce((function(e,n){return n.YunFuWuZhangDan_YueFen==a&&(e+=n.YunFuWuZhangDan_FeiYong),e}),0);t.push(i)};for(r.s();!(e=r.n()).done;)l()}catch(e){r.e(e)}finally{r.f()}var u=o.init(document.getElementById("model-test")),s={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"white",borderColor:"#E8E8E8",borderWidth:1,textStyle:{color:"black",fontSize:12,textShadowBlur:15}},grid:{left:"2%",right:"4%",bottom:"3%",top:"16%",containLabel:!0},xAxis:[{type:"category",data:this.monthList.map((function(e){return e+"月"})),axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value",name:"总金额"+a,nameTextStyle:{align:"center"},splitLine:{lineStyle:{width:.6}},splitNumber:3}],series:[{name:"账单总金额",type:"bar",barWidth:"36%",itemStyle:{color:"skyblue"},data:t}]};u.setOption(s),window.addEventListener("resize",(function(){u.resize()}))},handleChange:function(e,n,t){this.filteredInfo=n},clearFilters:function(){this.filteredInfo=null}},watch:{monthBillingResource:{handler:function(e){this.billingChart(),this.clearFilters()}}}},s=(t("0d33"),t("2877")),c=Object(s.a)(u,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("a-collapse",{attrs:{activeKey:e.collapseActiveKey,expandIconPosition:"right"}},[t("a-collapse-panel",{key:"1"},[t("span",{attrs:{slot:"header"},slot:"header"},[t("a-icon",{attrs:{type:"bar-chart"}}),t("span",[e._v(" 月账单统计图")])],1),t("div",{staticStyle:{width:"auto",height:"18vw"},attrs:{id:"model-test"}})]),t("a-collapse-panel",{key:"2"},[t("span",{attrs:{slot:"header"},slot:"header"},[t("a-icon",{attrs:{type:"bars"}}),t("span",[e._v(" 月账单统计表")])],1),t("a-table",{attrs:{columns:e.columns,"data-source":e.monthBillingResource,pagination:!1,rowKey:"YunFuWuZhangDan_VISIBLE_NAME"},on:{change:e.handleChange},scopedSlots:e._u([{key:"costDate",fn:function(n){return t("span",{},[e._v(e._s(n.YunFuWuZhangDan_ZhangDanNianFen)+"-"+e._s(n.YunFuWuZhangDan_YueFen))])}},{key:"currencyType",fn:function(n){return t("span",{},[n.YunFuWuZhangDan_HuoBiDanWei.includes("人民币")?t("a-icon",{staticStyle:{"font-size":"18px"},attrs:{type:"pay-circle",theme:"filled"}}):n.YunFuWuZhangDan_HuoBiDanWei.includes("美元")?t("a-icon",{staticStyle:{"font-size":"18px"},attrs:{type:"dollar-circle",theme:"filled"}}):n.YunFuWuZhangDan_HuoBiDanWei.includes("欧元")?t("a-icon",{staticStyle:{"font-size":"18px"},attrs:{type:"pound-circle",theme:"filled"}}):e._e()],1)}},{key:"cloudProvider",fn:function(n){return t("span",{},[n.YunFuWuZhangDan_YunTiGongShang.includes("阿里云")?t("span",[t("span",{staticClass:"iconfont icon2-aliyun1 cloudProviderIcon"}),t("span",[e._v(e._s(n.YunFuWuZhangDan_YunTiGongShang))])]):n.YunFuWuZhangDan_YunTiGongShang.includes("aws")?t("span",[t("span",{staticClass:"iconfont icon2-aws cloudProviderIcon"}),t("span",[e._v(e._s(n.YunFuWuZhangDan_YunTiGongShang))])]):n.YunFuWuZhangDan_YunTiGongShang.includes("腾讯")?t("span",[t("span",{staticClass:"iconfont icon2-tengxunyun2 cloudProviderIcon"}),t("span",[e._v(e._s(n.YunFuWuZhangDan_YunTiGongShang))])]):n.YunFuWuZhangDan_YunTiGongShang.includes("azure")?t("span",[t("span",{staticClass:"iconfont icon2-azure cloudProviderIcon"}),t("span",[e._v(e._s(n.YunFuWuZhangDan_YunTiGongShang))])]):e._e()])}},{key:"cost",fn:function(n){return t("span",{staticStyle:{color:"green"}},[n.YunFuWuZhangDan_HuoBiDanWei.includes("人民币")?t("span",[e._v("¥")]):n.YunFuWuZhangDan_HuoBiDanWei.includes("美元")?t("span",[e._v("$")]):n.YunFuWuZhangDan_HuoBiDanWei.includes("欧元")?t("span",[e._v("€")]):e._e(),e._v(" "+e._s(n.YunFuWuZhangDan_FeiYong)+" ")])}}])})],1)],1)}),[],!1,null,"1b93d8d6",null).exports,h=(t("a9e3"),t("8ba4"),t("b680"),{data:function(){return{}},props:["id","yearPieData","year"],mounted:function(){},methods:{modelPie:function(){var e=o.init(document.getElementById(this.id)),n={title:{text:"one"==this.id?"本年度("+this.year+"年)云供应商费用占比":"上一年("+this.year+"年)云供应商费用占比",left:"center",top:"one"==this.id?"10%":"6%",textStyle:{fontWeight:"normal",fontSize:13}},tooltip:{trigger:"item",backgroundColor:"white",borderColor:"#E8E8E8",borderWidth:1,formatter:"{b}({c} , {d}%)",textStyle:{color:"black",fontSize:12,textShadowBlur:15}},legend:{itemWidth:16,itemHeight:10,bottom:"one"==this.id?"3%":"6%",formatter:function(e){return e.length>10?e.substring(0,9)+"...":e}},color:["#5698F5","#E2C93D","#FF7070","#35A1D3","#4E8975","#5A5476","#FF9393","#254117","#7f02f4","#029ef4","#0556f7","#6905f7","#c405f7","#7d6b92","#a9e8c2","#C1EBDD","#1c9a4e","#f76f0a","#ae6987","#8c1649","#05f7da"],series:[{name:"金额",type:"pie",radius:["42%","56%"],left:"center",top:"one"==this.id?"-8%":"-16%",label:{show:!1},data:this.yearPieData}]};e.setOption(n),window.addEventListener("resize",(function(){e.resize()}))}},watch:{yearPieData:{handler:function(e){this.modelPie()}}}}),d={name:"YearBilling",components:{YearBillingCloudProvicer:Object(s.a)(h,(function(){var e=this.$createElement;return(this._self._c||e)("div",{staticStyle:{width:"auto",height:"15vw"},attrs:{id:this.id}})}),[],!1,null,null,null).exports},props:["yearBillingResource","yearList","billingTypeClicked"],data:function(){return{currentYearPieData:[],lastYearPieData:[]}},mounted:function(){this.billingTypeClicked&&this.billingChart()},methods:{getYearBillingData:function(){var e,n=[],t=Object(i.a)(Object(a.a)(this.yearList).sort((function(e,n){return e-n})));try{for(t.s();!(e=t.n()).done;){var r,l=e.value,o=0,u=Object(i.a)(this.yearBillingResource);try{for(u.s();!(r=u.n()).done;){var s=r.value;s.YunFuWuZhangDan_ZhangDanNianFen==l&&(o+=s.YunFuWuZhangDan_FeiYong)}}catch(e){u.e(e)}finally{u.f()}n.push(this.formatNumber(o))}}catch(e){t.e(e)}finally{t.f()}return n},getYearPieData:function(e){var n,t=[],a=this.yearBillingResource.filter((function(n){return n.YunFuWuZhangDan_ZhangDanNianFen==e})),r=new Set(a.map((function(e){return e.YunFuWuZhangDan_YunTiGongShang}))),l=Object(i.a)(r);try{for(l.s();!(n=l.n()).done;){var o,u=n.value,s=0,c=Object(i.a)(a);try{for(c.s();!(o=c.n()).done;){var h=o.value;h.YunFuWuZhangDan_YunTiGongShang==u&&(s+=h.YunFuWuZhangDan_FeiYong)}}catch(e){c.e(e)}finally{c.f()}t.push({name:u,value:this.formatNumber(s)})}}catch(e){l.e(e)}finally{l.f()}return t},billingChart:function(){this.currentYearPieData=this.getYearPieData(this.yearList[0]),this.lastYearPieData=this.getYearPieData(this.yearList[1]),this.getYearBillingData();var e=this.yearBillingResource.length?"("+this.yearBillingResource[0].YunFuWuZhangDan_HuoBiDanWei.slice(2,10)+")":"",n=o.init(document.getElementById("yearBilling")),t={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"white",borderColor:"#E8E8E8",borderWidth:1,textStyle:{color:"black",fontSize:12,textShadowBlur:15}},grid:{left:"4%",right:"0%",bottom:"10%",top:"16%",containLabel:!0},xAxis:[{type:"category",data:this.yearList.map((function(e){return e+"年"})).sort(),axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value",name:"总金额"+e,nameTextStyle:{align:"center"},splitLine:{lineStyle:{width:.6}},splitNumber:3,axisLabel:{formatter:function(e){return e>=1e4?e/1e4+"万":e}}}],series:[{name:"账单总金额",type:"bar",barWidth:"22%",itemStyle:{color:"skyblue"},data:this.getYearBillingData()}]};n.setOption(t),window.addEventListener("resize",(function(){n.resize()}))},formatNumber:function(e){return Number.isInteger(e)?e:Number(e.toFixed(2))}},watch:{yearBillingResource:{handler:function(e){this.billingChart()}}}},g={data:function(){return{billingType:"year",billingTypeClicked:!1,cloudProvider:"全部云供应商",payElement:"",year:"",yearList:[],payElementSet:new Set,cloudProviderSet:new Set(["全部云供应商"]),billingResource:[],monthBillingResource:[],yearBillingResource:[]}},components:{MonthBilling:c,YearBilling:Object(s.a)(d,(function(){var e=this.$createElement,n=this._self._c||e;return n("div",{staticStyle:{border:"1px solid #D8D8D8"}},[n("a-row",{attrs:{gutter:0}},[n("a-col",{attrs:{span:16}},[n("div",{staticStyle:{height:"31vw"},attrs:{id:"yearBilling"}})]),n("a-col",{attrs:{span:8}},[n("a-row",[n("div",[n("YearBillingCloudProvicer",{attrs:{id:"one",yearPieData:this.currentYearPieData,year:this.yearList[0]}})],1)]),n("div",{staticStyle:{"border-top":"1px solid #E8E8E8","margin-right":"50px","margin-left":"50px","margin-top":"-1px"}}),n("a-row",[n("div",[n("YearBillingCloudProvicer",{attrs:{id:"two",yearPieData:this.lastYearPieData,year:this.yearList[1]}})],1)])],1)],1)],1)}),[],!1,null,null,null).exports},mounted:function(){var e=(new Date).getFullYear();this.year=e;for(var n=e;n>=e-4;n--)this.yearList.push(n);this.getBillingResource()},methods:{billingTypeChange:function(){this.billingTypeClicked=!0},getBillingResource:function(){var e=this;Object(r.b)({url:l.a.cmdbModelUrl+"/import-v2/?model_code=YunFuWuZhangDan&per_page=100000",method:"get",params:""}).then((function(n){if(200==n.code){e.requestData=n.data.data;var t,r=Object(i.a)(e.requestData);try{for(r.s();!(t=r.n()).done;){var l=t.value;e.billingResource.push(l.data),e.payElementSet.add(l.data.YunFuWuZhangDan_FuKuanZhuTi)}}catch(e){r.e(e)}finally{r.f()}e.payElement=Object(a.a)(e.payElementSet)[0],e.payElementChange()}else e.$message.error("获取费用信息失败："+message)}))},getFilterBillingResource:function(){var e=this,n=[];n="全部云供应商"==this.cloudProvider?this.billingResource.filter((function(n){return n.YunFuWuZhangDan_FuKuanZhuTi==e.payElement})):this.billingResource.filter((function(n){return n.YunFuWuZhangDan_FuKuanZhuTi==e.payElement&&n.YunFuWuZhangDan_YunTiGongShang==e.cloudProvider})),this.yearBillingResource=n,this.monthBillingResource=n.filter((function(n){return n.YunFuWuZhangDan_ZhangDanNianFen==e.year})).sort((function(e,n){return n.YunFuWuZhangDan_YueFen-e.YunFuWuZhangDan_YueFen}))},payElementChange:function(){this.cloudProviderSet=new Set(["全部云供应商"]);var e,n=Object(i.a)(this.billingResource);try{for(n.s();!(e=n.n()).done;){var t=e.value;this.payElement==t.YunFuWuZhangDan_FuKuanZhuTi&&this.cloudProviderSet.add(t.YunFuWuZhangDan_YunTiGongShang)}}catch(e){n.e(e)}finally{n.f()}this.cloudProvider="全部云供应商",this.getFilterBillingResource()}},computed:{}},p=(t("3e83"),Object(s.a)(g,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("a-card",{attrs:{bodyStyle:{padding:"0px"}}},[t("a-page-header",{attrs:{title:"云服务商账单统计"}},[t("a-breadcrumb",{attrs:{slot:"subTitle",separator:">"},slot:"subTitle"},[t("a-breadcrumb-item",{staticStyle:{color:"rgba(0, 0, 0, 0.65)"}},[e._v("费用统计")]),t("a-breadcrumb-item",{staticStyle:{color:"rgba(0, 0, 0, 0.65)"}},[e._v("云服务商账单统计")])],1)],1)],1),t("a-card",[t("a-row",[t("a-radio-group",{style:{marginBottom:"8px"},attrs:{"button-style":"solid"},on:{change:e.billingTypeChange},model:{value:e.billingType,callback:function(n){e.billingType=n},expression:"billingType"}},[t("a-radio-button",{attrs:{value:"year"}},[e._v(" 年账单统计 ")]),t("a-radio-button",{attrs:{value:"month"}},[e._v(" 月账单统计 ")])],1),t("span",{staticStyle:{"margin-left":"16px"}},[t("span",[e._v("付款主体：")]),t("a-select",{staticStyle:{width:"260px"},on:{change:e.payElementChange},model:{value:e.payElement,callback:function(n){e.payElement=n},expression:"payElement"}},e._l(e.payElementSet,(function(n,a){return t("a-select-option",{key:a,attrs:{value:n}},[e._v(" "+e._s(n)+" ")])})),1)],1),t("span",{staticStyle:{"margin-left":"16px"}},[t("span",[e._v("云供应商：")]),t("a-select",{staticStyle:{width:"160px"},on:{change:e.getFilterBillingResource},model:{value:e.cloudProvider,callback:function(n){e.cloudProvider=n},expression:"cloudProvider"}},e._l(e.cloudProviderSet,(function(n,a){return t("a-select-option",{key:a,attrs:{value:n}},[e._v(" "+e._s(n)+" ")])})),1)],1),t("span",{directives:[{name:"show",rawName:"v-show",value:"month"==e.billingType,expression:"billingType == 'month'"}],staticStyle:{"margin-left":"16px"}},[t("span",[e._v("年份：")]),t("a-select",{staticStyle:{width:"120px"},on:{change:e.getFilterBillingResource},model:{value:e.year,callback:function(n){e.year=n},expression:"year"}},e._l(e.yearList,(function(n,a){return t("a-select-option",{key:a,attrs:{value:n}},[e._v(" "+e._s(n+"年")+" ")])})),1)],1)],1),t("a-row",["year"==e.billingType?t("YearBilling",{attrs:{billingTypeClicked:e.billingTypeClicked,yearBillingResource:e.yearBillingResource,yearList:e.yearList}}):e._e(),"month"==e.billingType?t("MonthBilling",{attrs:{monthBillingResource:e.monthBillingResource,year:e.year}}):e._e()],1)],1)],1)}),[],!1,null,"d16b3f22",null));n.default=p.exports},"3e83":function(e,n,t){"use strict";var a=t("f4e0");t.n(a).a},c592:function(e,n,t){},f4e0:function(e,n,t){}}]);